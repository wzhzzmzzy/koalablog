---
import { MarkdownSource } from '@/lib/prisma'
import { readPresetSource } from '@/lib/prisma/pages'
import { marked } from 'marked'
import Layout from './layout.astro'

const env = Astro.locals.runtime.env

const title = await env.KOALA.get('title')
const presetSource = await readPresetSource(env, [MarkdownSource.Nav])
const markup = marked(presetSource[0].content ?? '')
---
<Layout>
  <header>
    <h1>{title}</h1>
    <nav>
      <Fragment set:html={markup} />
    </nav>
  </header>
  <main>
    <slot />
  </main>
  <footer>
    <slot name="footer" />
  </footer>
</Layout>
