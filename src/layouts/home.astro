---
import Head from '@/components/head/index.astro'
import { MarkdownSource } from '@/db'
import { readPreset } from '@/db/markdown'
import { rawMd } from '@/lib/markdown'
import Layout from './layout.astro'

interface Props {
  title?: string
  desc?: string
}

const { title: metaTitle, desc } = Astro.props

const env = Astro.locals.runtime?.env || {}

const title = Astro.locals.config.pageConfig.title ?? ''
const presetSource = await readPreset(env, MarkdownSource.Nav)
const markup = rawMd().render(presetSource?.content ?? '')
---
<Layout>
  <Fragment slot="meta">
    <Head title={metaTitle || title} desc={desc} />
    <slot name="meta" />
  </Fragment>
  <header>
    <h1>{title}</h1>
    <nav>
      <Fragment set:html={markup} />
    </nav>
  </header>
  <main>
    <slot />
  </main>
  <footer>
    <slot name="footer" />
  </footer>
</Layout>
